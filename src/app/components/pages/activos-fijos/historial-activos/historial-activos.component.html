<div class="container-fluid">
    <!-- ventana nro 3 - salida -->
    <div class="grid-container">

        <div class="title">Historial de Activos Fijos</div>

        <div class="find">
            <div class="auditoriaForm">
                <mat-form-field class="fila1-fecha" appearance="fill">
                    <mat-label>Rango de Fecha</mat-label>
                    <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                        <input matStartDate formControlName="start" placeholder="Fecha Inicio">
                        <input matEndDate formControlName="end" placeholder="Fecha Final">
                    </mat-date-range-input>
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-date-range-picker #picker></mat-date-range-picker>
                    <mat-icon (click)="clearDate($event)" style=" position: absolute;
                            float: right;
                            top: -6px;
                            margin-left: 190px;
                            cursor: pointer;
                            color: rgba(0, 0, 0, 0.54);">clear</mat-icon>
                    <mat-error *ngIf="range.controls.start.hasError('matStartDateInvalid')">Fecha
                        Invalida</mat-error>
                    <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')">Fecha
                        Invalida</mat-error>
                </mat-form-field>

                <mat-form-field class="fila1-buscar" appearance="fill">
                    <mat-label>Buscar</mat-label>
                    <input matInput type="text" (keyup)="applyFilter($event)">
                </mat-form-field>

                <button type="button" class="fila1-excel" color="primary" mat-flat-button
                    (click)="buscarReporteControlActivos()">
                    <mat-icon aria-label="person">search</mat-icon>Buscar
                </button>
                <button type="button" class="fila1-excel" color="primary" mat-flat-button (click)="generateExcel()">
                    <mat-icon aria-label="person">create_new_folder</mat-icon>Exportar
                </button>
                <button type="button" class="fila1-eliminar" color="primary" mat-flat-button
                    (click)="eliminarActivos()">
                    <mat-icon aria-label="person">delete</mat-icon>Eliminar
                </button>




                <button type="button" class="fila1-excel-orange" color="primary" mat-flat-button
                    (click)="imprimirTicket()">
                    <mat-icon aria-label="person">print</mat-icon>Ticket
                </button>
                <button type="button" class="fila1-excel-orange" color="primary" mat-flat-button
                    (click)="buscarArchivosAdjuntos()">
                    <mat-icon aria-label="person">attach_file</mat-icon>Adjuntos
                </button>

                <button type="button" class="fila1-eliminar-yellow" color="primary" mat-flat-button
                    (click)="historialUbicacionActivos()">
                    <mat-icon aria-label="person">place</mat-icon>Ubicaciones
                </button>

                <button type="button" class="fila1-excel-cyan" color="primary" mat-flat-button
                    (click)="historialPrestamos()">
                    <mat-icon aria-label="person">build</mat-icon>Préstamos/Reparaciones
                </button>

                <button type="button" class="fila1-excel-purple" color="primary" mat-flat-button
                    (click)="familiaresActivo()">
                    <mat-icon aria-label="person">supervised_user_circle</mat-icon>Familiares Activo
                </button>

                <button type="button" class="fila1-eliminar-danger" color="primary" mat-flat-button
                    (click)="regresar()">
                    <mat-icon aria-label="person">arrow_left</mat-icon>Regresar
                </button>




            </div>

            <div class="row">
                <div class="col-md-12 tabla">
                    <table mat-table class="mat-elevation-z8" #table [dataSource]="dataSource">

                        <ng-container matColumnDef="select">
                            <th mat-header-cell *matHeaderCellDef>
                                <mat-checkbox (change)="$event ? toggleAllRows() : null"
                                    [checked]="selection.hasValue() && isAllSelected()"
                                    [indeterminate]="selection.hasValue() && !isAllSelected()"
                                    [aria-label]="checkboxLabel()">
                                </mat-checkbox>
                            </th>
                            <td mat-cell *matCellDef="let row">
                                <mat-checkbox (click)="$event.stopPropagation()"
                                    (change)="$event ? selection.toggle(row) : null"
                                    [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                                </mat-checkbox>
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="empresa">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Empresa</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.empresa}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="sede">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Sede</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.sede}} </td>
                        </ng-container>
                        <ng-container matColumnDef="piso">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Piso</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.piso}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="area">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Area</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.area}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="centroCosto">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Centro Costo</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.centroCosto}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="responsable">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Responsable
                            <th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.responsable}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="celular">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Celular
                            <th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.celular}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="imei">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Imei
                            <th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.imei}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="capacidad">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Capacidad
                            <th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.capacidad}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="codUsuario">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Cod. Usuario</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.codUsuario}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="claseActivo">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Clase Activo</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.claseActivo}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="ubicacion">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Ubicación
                            <th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.ubicacion}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="codActivo">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Cod. Activo</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.codActivo}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="descripcion">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Descripción</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.descripcion}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="marca">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Marca</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.marca}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="modelo">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Modelo</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.modelo}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="serie">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Serie</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.serie}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="color">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Color</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.color}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="medida">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Medida</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.medida}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="serieMotor">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Serie Motor</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.serieMotor}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="serieChasis">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Serie Chasis</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.serieChasis}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="placa">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Placa</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.placa}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="tipoCombustible">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Tipo Combustible</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.tipoCombustible}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="tipoCaja">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Tipo Caja</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.tipoCaja}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="cantidadAsiento">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Cantidad Asiento</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.cantidadAsiento}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="cantidadEje">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Cantidad Eje</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.cantidadEje}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="anoFabricacion">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Año Fabricación</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.anoFabricacion}}
                            </td>
                        </ng-container>

                        <ng-container matColumnDef="usoDesuso">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Uso/Desuso</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det"> {{data_det.usoDesuso}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="observacion">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Observación</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.observacion}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="fecRegistro">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">F. Registro</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.fecRegistro}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="fechaAlta">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">F. Alta</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.fechaAlta | date: 'dd/MM/Y'}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="precioTotal">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Precio Total</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.precioTotal | number: '1.2-2' }}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="depreciacion">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Depreciación</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.depreciacion}} %
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="depreciacionMensual">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Depreciación Mensual</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{ data_det.depreciacionMensual | number: '1.2-2' }}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="valorActual">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Valor Actual</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.valorActual | number: '1.2-2' }}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="nuevoCodActivo">
                            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Nuevo Cod. Activo</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                {{data_det.nuevoCodActivo}}
                            </td>
                        </ng-container>




                        <ng-container matColumnDef="acciones">
                            <th mat-header-cell *matHeaderCellDef>Acciones</th>
                            <td class="mat-header-cell" mat-cell *matCellDef="let data_det">
                                <!-- <a mat-icon-button style="margin-right:5px;" (click)="openModificarActivo(data_det.codActivoFijo)">
                                        <mat-icon color="success">create</mat-icon>
                                    </a> -->

                                <a mat-icon-button (click)="EliminarRegistro(data_det.codActivoFijo)">
                                    <mat-icon color="warn">delete</mat-icon>
                                </a>

                                <a mat-icon-button (click)="depreciacionActivo(data_det)">
                                    <mat-icon color="primary">trending_down</mat-icon>
                                </a>

                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
                        <tr mat-row *matRowDef="let row; columns: columnsToDisplay;"
                            [ngClass]="{'highlight': selectedRowIndex == row.codActivoFijo}" (click)="highlight(row)">
                        </tr>

                    </table>
                    <mat-paginator [pageSizeOptions]="[10, 20, 40]" showFirstLastButtons
                        aria-label="Select page of periodic elements">
                    </mat-paginator>
                </div>
            </div>
        </div>


    </div>


    <div id="print-section" style="position: absolute; left: -999em;">
        <svg class="barcode" id="barcode" viewBox="0 0 273 200"></svg>
    </div>
    <div id="print-section2" style="position: absolute; left: -999em;">
        <svg class="barcode" id="barcode2" viewBox="0 0 273 200"></svg>
    </div>

</div>


<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin">
    <p style="color: white; text-align: center; ">Cargando... </p>
</ngx-spinner>